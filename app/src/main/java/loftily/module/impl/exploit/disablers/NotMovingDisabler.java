package loftily.module.impl.exploit.disablers;

import loftily.event.impl.packet.PacketSendEvent;
import loftily.module.impl.exploit.Disabler;
import loftily.value.impl.BooleanValue;
import loftily.value.impl.mode.Mode;
import net.lenni0451.lambdaevents.EventHandler;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketPlayer;

public class NotMovingDisabler extends Mode<Disabler> {
    private final BooleanValue notRotating = new BooleanValue("NotMoving-NotRotating", false);
    
    public NotMovingDisabler() {
        super("NotMoving");
    }
    
    @EventHandler
    public void onPacketSend(PacketSendEvent event) {
        Packet<?> packet = event.getPacket();
        if (packet instanceof CPacketPlayer) {
            if (!((CPacketPlayer) packet).getMoving() && (!notRotating.getValue() || !((CPacketPlayer) packet).getRotating())) {
                event.setCancelled(true);
            }
        }
    }
}
