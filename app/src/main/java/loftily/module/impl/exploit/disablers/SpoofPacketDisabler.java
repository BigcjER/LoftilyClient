package loftily.module.impl.exploit.disablers;

import loftily.event.impl.player.motion.MotionEvent;
import loftily.module.impl.exploit.Disabler;
import loftily.utils.client.PacketUtils;
import loftily.value.impl.BooleanValue;
import loftily.value.impl.NumberValue;
import loftily.value.impl.mode.Mode;
import net.lenni0451.lambdaevents.EventHandler;
import net.minecraft.network.play.client.CPacketPlayer;

public class SpoofPacketDisabler extends Mode<Disabler> {
    private final NumberValue yOffset = new NumberValue("SpoofPacket-OffsetY", -999, -2048, 2048);
    private final NumberValue xzOffset = new NumberValue("SpoofPacket-XZOffset", -999, -2048, 2048);
    private final BooleanValue spoofGround = new BooleanValue("SpoofPacket-SpoofGround", true);
    
    public SpoofPacketDisabler() {
        super("SpoofPacket");
    }
    
    @EventHandler
    public void onMotionEvent(MotionEvent event) {
        if (event.isPre()) {
            PacketUtils.sendPacket(new CPacketPlayer.Position(
                    mc.player.posX + xzOffset.getValue(),
                    mc.player.posY + yOffset.getValue(),
                    mc.player.posZ + xzOffset.getValue(),
                    spoofGround.getValue() || mc.player.onGround));
        }
    }
}
